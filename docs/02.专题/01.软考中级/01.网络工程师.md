---
title: 网络工程师
date: 2022-04-08 16:01:40
permalink: /wanggong/
categories:
  - 专题
  - 软考中级
tags:
  - 

---

# 网络工程师笔记

## 1. 计算机硬件基础

### 1.1. 数据的表示

#### 1.1.1. R进制（逢R进一）

二进制转10进制：

例：$(111000)_2$转化为十进制数。

位权展开：$2^5*1+2^4*1+2^3*1+2^2*0+2^1*0+2^0*0=56$

#### 1.1.2. 二进制，八进制，十六进制互转

二进制转八进制：从右往左起，每三位 二进制 转一位八进制。不足三位的在最左边加0补齐。

 八转二：对每一位八进制数转换为三位二进制表示。

二进制转十六进制：从右往左起，每四位 二进制 转一位十六进制。不足四位的在最左边加0补齐。

 十六转二：对每一位十六进制数转换为四位二进制表示。

#### 1.1.3. 原码，反码，补码

**原码**：最高位为符号位，0表示正数，1表示复数。其中数值0有+0与-0之分。其数值范围$-(2^{n-1}-1)$~$(2^{n-1}-1)$。8位时范围$-127$～$+127$

**反码**：正数的反码与原码相同；负数符号位不变，其余位取反。数值0有两种表示方式。数值范围$-(2^{n-1}-1)$~$(2^{n-1}-1)$。8位时范围$-127$～$+127$

**补码**：正数的补码与原码相同；负数的补码在反码基础上加1。数值0只有一种表示法，即：0000 0000。数值范围$-2^{n-1}$~$2^{n-1}-1$。8位时范围$-127$～$+127$，**适合数字加减运算**

**移码**：在补码基础上符号位取反，数值0只有一种表示法，即：1000 0000。

### 1.2. 逻辑运算

**与运算（＆）**：参加运算的两个数据，按二进制位进行 “与” 运算。 运算规则： 0&0=0; 0&1=0; 1&0=0; 1&1=1;

**或运算（|）**：参加运算的两个对象，按二进制位进行 ”或“ 运算。运算规则： 0|0 = 0; 0|1 = 1; 1|0 = 1; 1|1 = 1;

**非运算**：（）：参加运算的两个对象，按二进制位进行 “非” 运算。运算规则： 0=1 “非'0 等千 1; 1 =0 “非“1 等千 0

**异或运算（＾）**：参加运算的两个数据，按二进制位进行 “异或“ 运算。**同为0异为1**；

### 1.3. 计算机结构

![](https://lgx_248920070.gitee.io/lgxblog/img/202204181822100.png)

**CPU**由运算器、控制器和寄存器组成。

**总线**：包括数据总线，地址总线，控制总线。总线分别传递对应的信息。
::: center
![](https://lgx_248920070.gitee.io/lgxblog/img/主机.draw.svg)
:::

**运算器**：完成算术运算、逻辑运算和移位操作。主要部件算术逻辑单元（ALU）、累加器、标志寄存器、寄存器组、多路转换器和数据总线。

累加寄存器AC：暂存中间的结果。

**控制器**：实现指令读入、寄存、译码和执行过程有序的发出控制信号。主要部件：程序计数器PC、指令寄存器、指令译码器、时序产生器和信号发生器组成。 

程序计数器PC：保存指令所在的地址。

**寄存器**：暂存寻址和计算过程的信息。通常分为数据寄存器、地址寄存器、状态寄存器、控制寄存器。

### 1.4. 指令系统基础-寻址方式

**指令由操作码和操作数（地址码）组成。指令长度分为固定长度和可变长度两种。**

- **操作码**：要做什么样的操作，加减乘除。
- **地址码**：操作数的地址。

**寻址方式**：寻找操作数的方式。

- **立即寻址**：指令的地址码字段给出的不是操作数的地址而是操作数本身。其特点是访问一次存储器就可同时取出指令和操作数。

- **直接寻址（寄存器寻址）**：指令的地址码字段给出操作数所在存储单元地址（寄存器号）。

- **变址寻址**：操作数的地址由某个变址寄存器的内容和位移量相加。

- **间接寻址（寄存器间接寻址）**：操作数的地址是主存（寄存器）中的存储单元的内容。

- **相对寻址**：操作数的地址由指令寄存器的内容与位移量相加。

### 1.5. CISC（**复杂指令计算机**）和RISC（**简单指令计算机**）

**复杂指令计算机CISC：**

- 指令采用可变长指令格式，指令系统丰富，使用频率差别大，处理特殊任务效率高。

- 支持更多的数据类型和寻址方式。

- 指令系统对应的控制信号复杂，大多采用微程序控制方式。

- 高级语言实现简单，效率高

**简单指令计算机RISC**

- 采取定长指令格式，精简指令数量，使用频率接近。

- 采用寄存器操作，寻址方式少。

- 大部分指令都采用硬联控制实现。

- 优化编译程序来支持高级程序语言，需要较大的存储空间

### 1.6. 流水线

将一个操作分为多个可独立处理的子操作（如取指令、译码、取操作数、执行），每个子操作在一个专门的硬件站上执行，这样一个操作需要流水线上多个站的处理才能完成。
::: center
![](https://lgx_248920070.gitee.io/lgxblog/img/202204121229537.svg)
:::

**流水线执行时间**：$T_k=(t_1+t_2+t_3)+(n-1)t_1$

最后的$t_1$ 为流水线周期，表示流水线执行时间最长的一段。

#### 6.1.1. 流水线-技术指标

- 吞吐率：$T_p=\frac {n}{T_k}$ 

  $n$为指令集数，$T_k$为流水线时间。

- 理论最大吞吐率：$t_p=\frac{1}{T}$ 

  $T$ 为流水线周期。

- 加速比：$S=\frac{T_s}{T_k}$

  $T_s$ 不使用流水线执行所需的时间。$T_k$ 为流水线时间。

- 效率：工作部件/总工作部件，具体需要看时间。

### 1.7. 存储系统

根据存储器在计算机系统中所起的作用，可分为**主存储器（内存）**， **辅助存储器（外存）**，**高速缓冲存储器（Cache）**，**控制存储器**等。为了解决对存储器要求容量大，速度快，成本低三者之间的矛盾，目前通常采用多级存储结构，即使用高速缓冲存储器、主存储器和外存储器。

#### 1.7.1. 存储器的储存方式

**顺序存取**（磁带）**直接存取**（硬盘）**随机存取**（内存）**相关存取**（Cache）

#### 1.7.2. 主存储器

主存储器又称**内存**或**主存**，由一片或多片存储芯片配以控制电路组成的。

按照存取方式分类，可分为**随机存储器RAM**（**断电数据丢失**，如内存）、**只读存储器ROM**（断电数据不丢失）
主存储器（内存）采用随机存取方式，需要对每个存储单元进行编址。

存储器总容量：$W＊B$

**W**：储存单元（word）的数量。

**B**：每个 word 由多少位（bit）组成。

主存储器（内存）采用**随机存取**方式，需要对每个存储单元进行编址。通常以word为单位进行标识，即每一个**字**一个地址，通常采用16进制表示。

存储容量相关术语：

**位**：用 bit 表示。— 个二进制表示1个bit。
**字节**：用 B 表示。Byte。1B = 8bit。
**字**： 表示CPU —次处理的二进制位数，通常为字节的整数倍。对应的字节长有： 8/16/32/64bit。

#### 1.7.3. 高速缓冲存储器（Cache）

高速存取指令和数据，存取速度快，但存储容量小。高速缓存是为了解决CPU 和主存速率不匹配，提高CPU 工作效率。

**命中率**：访问信息的概率。

例：假如执行过程中对Cache的访问次数为 $N1$ 和对主存访问为 $N2$ ，则Cache命中率为 $H＝\frac {N1}{(N1+N2)}$

平均存取时间：Cache的访问周期时间是T1、主存储器的访问周期时间是T2、命中率为H、则平均存取时间为：

$T＝H*T1+（1－H）T2$

**Cache 映射机制**：直接映射、全相联映射、组相联映射
**Cache 淘汰算法**：先进先出算法（FIFO）、最近最少使用算法、随机算法

#### 1.7.4. 外存储器

外存／辅存，存放系统程序和大型数据文件及数据库，存储容量大，存取速度慢，单位成本低。

### 1.8. 磁盘阵列（RAID）

**RAID 0**：需要两块以上磁盘，每个磁盘划分不同的区块，数据采用交叉存取和井行传输。这种磁盘利用率高(100%），读写速度最快，但由千没有数据差错控制，因此很容易发生数据错误。

**RAID 1**：磁盘成对组成，每个工作磁盘均有对应的映射，上面保存着与工作盘完全相同的数据，具有最高的安全性，但磁盘利用率为50%。

**RAID 3**：把奇偶校验码（只能查错不能纠错） 存在—个独立的磁盘，如果— 个磁盘失效，其上的数据可以通过其他盘上数据进行异或运算得到，读盘速度快，但写入速度慢。适用千图像处理等要求高吞吐率的场合，磁盘利用率：$\frac {n-1}{n}$ 

**RAID 5**：各块磁盘进行条带化分割，相同的条带进行分布式奇偶校验，检验数据平均分配在每—块硬盘上。磁盘利用率：$\frac {n-1}{n}$

**组合RAID 技术（RAID10）**：RAID1+0 以及RAID 0+1, 是RAID 0与 RAID 1 组合形式，它提供RAID 1 的安全保障同时提供RAID 0 近似的访问速度。RAID 1+0 拥有更高的数据安全性在企业中更常使用。

#### 1.8.1. RAID2.0

传统RAID是基于一块块硬盘来做RAID，现在的硬盘存储空间多则10T，这要是坏了一块，重构10T的数据耗时不说，还影响同RAID组中其他硬盘的工作效率。这时RAID2.0诞生了。

RAID2.0不再以硬盘为单位做RAID，而是先将同RAID组中的所有硬盘切块，基于块来构建RAID组。

RAID2.0+底层是RAID2.0，但是上层（LUN层）又做了精细化分。原理如下：

![](https://lgx_248920070.gitee.io/lgxblog/img/202204291434179.png)

大致可以看到，底层先对硬盘切条形成CK，把各个硬盘（必须是同一类型的硬盘）的条放在一起形成CKG。再对CKG横向切割（为了让数据分散到每一块硬盘中，纵向是相同硬盘，横向是不同硬盘）。再把切割完的数据块组成Extent，把多个Extent组成LUN，最后映射给主机使用。

同时可以看到热备盘也由原来的一块实体盘改成了由多个不同硬盘组成的块来充当热备盘。

### 1.9. 系统可靠性

串联系统：比如CPU无法正常工作了，那么内存也是无法正常工作，这个就叫做串联系统。

串联系统的可靠性： $R = R_1* R_2 * …… * R_n$

其中 $R_n$ 表示各个部件不能正常工作的概率。

并行系统：有几条内存同时工作，这个就叫做并行系统。

并行系统的可靠性： $R = 1-(1-R_1)* (1-R_2) * …… * (1-R_n)$

## 2. 操作系统概述

<iframe :src="$withBase('/markmap/1.html')" width="100%" height="400" frameborder="0" scrolling="No" leftmargin="0" topmargin="0"></iframe>

### 2.1. 程序设计语言

- 机器语言

- 汇编语言

- 高级语言

  - 编译语言

  - 翻译语言
- 4GL语言

###  2.2. 进程管理-进程的状态

::: center
![](https://lgx_248920070.gitee.io/lgxblog/img/202205071059480.svg)
:::

### 2.3. 进程管理-死锁问题

进程管理是操作系统的核心，但如果设计不当，就会出现死锁的问题。如果一个进程在等待一个可能发生的事，那进程就死锁了。

而如果一个或多个进程产生死锁，就会造成系统死锁。

#### 2.3.1. 产生死锁的必要条件

1. **互斥条件**：进程要求对所分配的资源进行排它性控制，即在一段时间内某资源仅为一进程所占用。
2. **请求和保持条件**：当进程因请求资源而阻塞时，对已获得的资源保持不放。
3. **不剥夺条件**：进程已获得的资源在未使用完之前，不能剥夺，只能在使用完时由自己释放。
4. **环路等待条件**：在发生死锁时，必然存在一个进程–资源的环形链。（你等我我等你）

#### 2.3.2. 死锁预防

1. 资源一次性分配：一次性分配所有资源，这样就不会再有请求了：（破坏请求条件）
2. 只要有一个资源得不到分配，也不给这个进程分配其他的资源：（破坏请保持条件）
3. 可剥夺资源：即当某进程获得了部分资源，但得不到其它资源，则释放已占有的资源（破坏不可剥夺条件）
4. 资源有序分配法：系统给每类资源赋予一个编号，每一个进程按编号递增的顺序请求资源，释放则相反（破坏环路等待条件）

### 2.4. 进程管理-银行家算法

银行家算法：分配资源的原则

- 当一个进程对资源的最大需求量不超过系统中的资源数时可以接纳该进程。
- 进程可以分期请求资源，但请求的总数不能超过最大需求量。
- 当系统现有的资源不能满足进程尚需资源数时，对进程的请求可以推迟分配，但总能使进程在有限的时间里得到资源。

![](https://lgx_248920070.gitee.io/lgxblog/img/202206291844029.jpg)

### 2.5. 进程管理-进程的互斥与同步

![](https://lgx_248920070.gitee.io/lgxblog/img/202206291840954.jpg)

### 2.6. 进程管理-PV操作

**临界区**：每个进程中访问临界资源的那段代码称为临界区。

**信号量**：是一种特殊的变量。

- 互斥信号量

- 同步信号量

**PV操作**：解决互斥和同步的问题。

PV操作是分开来看的：

**P操作**：使 $S=S-1$ ，若 $S>=0$ ，则该进程继续执行，否则该进程排入等待队列。

**V操作**：使 $S=S+1$ ，若 $S<=0$ ，则唤醒等待队列的一个进程。

### 2.7. 存储管理

#### 2.7.1. 页式存储

**基本原理**： 将各进程的虚拟空间划分为若干个长度相等的**页**， 把内存空间与页相等的大小划分为大小相等的片或页面， 采用请求调页或预调页技术实现内外存的统—管理。
**优点**： 利用率高， 产生内存碎片小， 内存空间分配及管理简单。

**缺点**：要有相应的硬件支持， 增加了系统开销； 若请求调页的算法选择不当， 则可能产生”抖动“ 现象。

**页表**：分成了页号和页内地址两块。页面大小为：**4KB**

![img](https://lgx_248920070.gitee.io/lgxblog/img/202207132124590.png)

![img](https://lgx_248920070.gitee.io/lgxblog/img/202207132121329.png)

#### 2.7.2. 页面置换算法

在进程运行的过程中，若其访问的页面不存在内存中，则会产生缺页中断。如果此时内存中没有空闲的页面，操作系统就需要在内存中选择一个页面将其移出，从而可以将需要访问的页面调入内存中。而用来选择淘汰哪一页的算法就叫做页面置换算法。

##### OPT(最佳置换算法)

最佳置换算法：每次选择淘汰的页面将是以后**永不使用**或者**最长时间内不在被访问**的页面。这样可以保证最低的缺页率。

例如：假如操作系统给进程分配了3个内存块，并且该进程接下来会依次访问7，5，2，3，6，2，7，1，6，7，2，3，7，2，7。

![v2-e4b526193b9505cb4f1fd476181212db_1440w](https://lgx_248920070.gitee.io/lgxblog/img/202207132137739.jpg)

如图所示，在第4步中，需要把3号页面调入内存，此时内存已经满了，所以需要从7，5，2中选择一个页面进行淘汰。按照**最佳置换**算法规则，往后寻找，此时2和7会被先后访问，所以把5号页面淘汰，即**最长时间内不在被访问**的页面。

##### FIFO(先进先出算法)

FIFO算法是最简单的页面置换算法。顾名思义，FIFO每次淘汰的页面是**最早进入内存**的页面。FIFO的实现方法是把调入内存的页面按先后顺序放入队列中，当需要置换页面时，选择队头的页面即可。

例如：假如操作系统给进程分配了3个内存块，并且该进程接下来会依次访问7，5，2，3，6，2，7，1，6，7，2，3，7，2，7。页面在内存中的表现如下所示：

![v2-8e87fd3057c0d4a6b0d53be379880aec_1440w 拷贝](https://lgx_248920070.gitee.io/lgxblog/img/202207141023845.jpg)

##### LRU(最近最久未使用算法)

LRU(Least Recently Used),每次淘汰的页面是**最近最久未使用的页面**。所以需要去记录该页面上次被访问以来所经历的时间t。当需要淘汰页面时，选择内存中现有页面中t最大的，即最近最久未使用的页面。

如：假如操作系统给进程分配了3个内存块，并且该进程接下来会依次访问7，5，2，3，6，2，7，1，6，7，2，3，7，2，7。页面在内存中的表现如下所示：

![v2-8e87fd3057c0d4a6b0d53be379880aec_1440w 拷贝](https://lgx_248920070.gitee.io/lgxblog/img/202207141043585.jpg)

##### LFU(最近最少使用算法)

LFU(最近最少使用算法)，它是基于"**如果一个数据在最近一段时间内使用次数很少，那么在将来一段时间内被使用的可能性也很小**“的思路。注意LFU和LRU算法的不同之处，LRU的淘汰规则是基于访问时间，而LFU是基于访问次数的。

如：假如操作系统给进程分配了3个内存块，并且该进程接下来会依次访问5，4，5，3，3、2、5、1、4。页面在内存中的表现如下所示：

![v2-03bf28285a5d7071659dab8d3fbbf59f_1440w 拷贝](https://lgx_248920070.gitee.io/lgxblog/img/202207141049984.jpg)

如图所示，在第八步中需要把1号页面调入内存，而此时内存已满，需要从5、2、3中选择一个页面进行淘汰。按照LFU规则，2号页面最近一段时间内使用次数为1，它是最小的。所以把2号页面淘汰出去。

#### 2.7.3. 文件管理

##### 树形目录结构

树形目录结构可以很方便地对文件进行分类，层次结构清晰，也能够更有效地进行文件的管理和保护。

**绝对路径**：完整的描述文件位置的路径就是绝对路径。

**相对路径**： 所谓相对路径，顾名思义就是自己相对目标的位置，不论将这些文件放到哪里，只要他们的相对关系没变， 就不会出错。

#### 2.7.4. 设备管理

##### 数据传输控制方式

按照 I/O 控制功能的强弱，以及和CPU之间联系方式的不同，可把I/O 设备的数据传输方式分为4种：

- 程序直接控制方式（ 查询控制方式）
- 中断控制方式
- DMA方式
- 通道方式

**程序控制方式**：在程序的主动控制下，通过读取状态寄存器了解接口的清况，完成相应的程序操作。为了及时了解接口的状态，需要时间密集的查询操作。CPU 效率低。

**中断控制方式**：当接口出现需要程序干预的事件，通过中断通知CPU , CPU 再读取状态寄存器，确定事件的种类，以便执行不同的代码处理。CPU 效率高而且及时。

**DMA(Direct Memory Access)控制方式**：CPU与接口的数据传送采用DMA 传送，即传送的具体过程由硬件( DMA控制器）完成，传送速度比通过CPU 快，尤其是在批量传送时效率很高。

## 3. 系统开发与项目管理基础

### 3.1. 软件生命周期

软件产品从计划到软件交付使用， 直到最终退出为止的过程。包括**可行性分析和项目开发计划**、**需求分析**、**概要设计**、**详细设计**、**编码**、**测试**及**维护**阶段。

### 3.2. 软件开发模型

分为 **瀑布模型**、**螺旋模型**、**喷泉模型**、**原型化模型**、**演化模型**

**瀑布模型**：严格遵循软件生命周期各阶段的固定顺序， —个阶段完成再进入另一阶段， 适用千结构化开发方法。
瀑布模型分为以下几个阶段：
软件计划、需求分析、软件设计、程序编码、软件测试、运行维护
瀑布模型的优点：

1. 为项目提供按阶段划分的检查点。
2. 当前阶段完成后， 只需关注后续阶段
3. 可在迭代模型中应用瀑布模型
4. 适用千大规模系统项目

瀑布模型的缺点：

1. 各阶段划分完全固定， 阶段之间产生大量文档， 增加了工作量。

2. 用户直到工程末期才能见到开发成果， 增加了开发风险。

3. 不适应用户需求变化。

**原型化模型**：开发人员对用户提出问题进行总结， 就主要需求达成—致意见， 开发—个原型并运行， 然后对原型进行反复修改， 使之完善。衡量原型化模型开发人员能力标准是快速获取需求能力。

优点： 用户需求清楚， 降低开发风险与成本用户参与决策， 减少项目管理， 要求完整的生命周期
缺点： 不适用大型系统， 系统难于维护。

**演化模型**：根据用户需求， 快速分析构造该软件的—个初始版本， 称之为原型， 根据用户在使用原型过程中提出的建议改进原型， 获得原型的新版本， 重复这一过程， 使用户最终获得满意的软件产品。

**螺旋模型**：将瀑布模型和原型模型结合， 强调了其它模型所忽略的风险分析， 适合大型复杂系统。
优点： 支持用户需求的动态变化， 降低风险。
缺点： 增加开发成本

**喷泉模型**：主要用千描述面向对象的开发过程， 核心的特点是迭代。所有开发活动没有明显边界， 允许各种开发活动交叉进行。

### 3.3. 软件测试

**白盒测试**：需要了解程序内部结构，测试用例是根据程序内部逻辑来设计。白盒测试用于软件的单元测试。

**黑盒测试**：对软件已经实现的功能是否满足需求进行测试和验证。黑盒测试不关心内部逻辑结构，只根据程序的功能说明来设计测试用例。黑盒测试用于软件的功能测试。

**灰盒测试**：关注输出对千输入的正确性，同时也关注内部表现，但不像白盒那样详细完整。

**测试的步骤**：单元测试、集成测试、系统测试、验收测试

### 3.4. 项目管理

项目管理可分为九大类，分别是：范围管理，时间管理，成本管理，质量管理，人力资源管理，沟通管理，风险管理，采购管理，整体管理。

#### 3.4.1. 时间管理

**甘特图**：用水平线段表示任务的工作阶段；线段的起点和终点对应任务的开始和完成；线段的长度表示完成任务所需时间。

![](https://lgx_248920070.gitee.io/lgxblog/img/202207272138273.svg)

相关计算：

**松弛时间**：关键路径所需时间 － 从节点开始到项目完成时间或该节点最晚开始时间－ 最早开始时间

**最晚开始时间**：关键路径用时 － 该节点到项目完成用时。

**最早开始时间**：项目开始到该节点需要的最长时间。

**关键路径**：所有路径所需时间最长的路径为关键路径，也可以理解为松弛时间为 0 的任务构成了完成整个工程的关键路径。

甘特图优点： 清晰的描述每个任务从何时开始到何时结束以及各任务之间的井行性。
甘特图缺点：不能反映任务之间的依赖关系，难以确定任务关键所在，也不能反映任务中有潜力部分。

## 4. 知识产权

**知识产权( intellectual property )** ， 也称知识所属权， 是指权利人对其智力劳动所创作的成果和经营活动中的标记、信誉所依法享有的专有权利。
知识产权是一种无形财产， 具有**专有性**、**时间性**和**地域性**的特点， 且大部分知识产权的获得需要法定的程序。知识产权有两类： **著作权**和**工业产权**。

### 4.1. 知识产权涉及的内容

**知识产权的分类**：著作权和工业产权及其所包含的权力种类。
所涉及的法律法规：
*《中华人民共和国著作权法》《计算机软件保护条例》《中华人民共和国商标法》《中华人民共和国专利法》《中华人民共和国反不正当竞争法》*
往年考试设涉及考点：
保护期限、知识产权人确定、侵权判断

| 客体类型                 | 权力类型                                       | 保护期限                                                     |
| ------------------------ | ---------------------------------------------- | ------------------------------------------------------------ |
| 公民作品                 | 署名权、修改权、保护作品完整权                 | 没有限制                                                     |
|                          | 发表权、使用权、获得报酬权                     | 作者终身机器死亡后的五十年。                                 |
| 单位作品                 | 发表权、使用权、获得报酬权                     | 首次发表后五十年， 若期间未发表， 不保护。                   |
| 公民软件作品             | 署名权、修改权                                 | 没有限制                                                     |
|                          | 发表权、复制权、发行权、出租权、信息网络传播权 | 作者终身机器死亡后的五十年， 合作开发， 以最后死亡作者为准。 |
|                          | 翻译权、使用许可权、获得报酬权、转让权         |                                                              |
| 单位软件作品             | 发表权、复制权、发行权、出租权、信息网络传播权 | 首次发表后五十年， 若期间未发表， 不保护。                   |
| 注册商标                 |                                                | 有效期十年（ 注册人死亡或倒闭一年后可注销， 期满6个月内必须续注） |
| 发明专利权               |                                                | 保护期二十年（ 自申请之日起）                                |
| 实用新型和外观设计专利权 |                                                | 保护期十年（ 自申请之日起）                                  |
| 商业秘密                 |                                                | 不确定， 公开后公众可用                                      |

### 4.2. 著作权

作者对其创作的作品享有的人身权和财产权自软件开发完成之日起保护期为50 年期满后，除人身权外其他权利终止。分为**著作人格权**与**著作财产权**。
**人格权**包括： 署名权、发表权、修改权和保护作品完整权
**财产权**包括： 发行权、出租权、展览权、表演权和信息网络传播权
合理使用是指可不经著作权人许可， 也无需支付报酬， 使用其作品。
公民作品保护期限为作者终身及死后50 年， 合作的作品， 以最后—名作者死亡为准。

**著作权归属**：

1. 职务开发软件著作权归单位。包括： 本职工作明确的开发目标或从事本职工作活动的结果。
2. 利用单位资金、专用设备、未公开的信息等物质技术条件， 并由单位承担责任的软件， 著作权归单位。
3. 合作开发软件著作权—般为共同所有， 如果有软件著作权协议， 按协议确定著作权归属。
4. 委托开发的软件， 著作权归属由委托人和受托人通过合同约定， 如果未明确， 著作权归属受托人。
5. 接受任务开发的软件， 著作权归属在合同中明确约定的—方， 未明确的， 属千软件开发单位。
6. 只进行组织、提供咨询意见、物质条件或其他辅助工作不享有著作权。

**侵权判定**：

1. 中国公民、法人和组织的作品， 不论发表是否发表均享有著作权。
2. 开发软件所用思想、处理过程、操作方法及数学概念不受保护。
3. 法规、决定、命令、立法文件、官方译文、新闻和通用数表不受保护。

**以下属于合理使用**：

1. 个人学习、研究或欣赏， 适当引用不构成侵权。
2. 为介绍、评论某—作品或说明某—问题， 在作品中适当引用他人已发表的作品。
3. 公开演讲内容、免费表演他人作品、不够成侵权。
4. 用户教学或科学研究不构成侵权。
5. 将汉语译成少数民族语言作品或盲文出版不构成侵权。

### 4.3. 专利权

由国务院相关部门授予的， 对发明创造者在规定的时间内享有的独占使用权。
发明专利的保护时限为自申请日起 20 年， 实用新型专利和外观设计专利为自申请日起 10 年。
两个以上申请人分别对同样的发明创造申请专利， 专利权授予最先申请的人。同时申请专利，在收到国务院专利行政部门通知后， 自行协商确定申请人，协商不成的均予以驳回。同样的发明创造，只能授予—项专利。

**强制实施许可**： 法律规定不经专利权人许可而实施专利权人之专利的不构成侵权。

**下列情况专利权归属单位**：

1. 履行本单位交付的本职工作外的任务所作出的发明。
2. 离职、退休或调动工作1 年后与原单位相关的发明。
3. 职务发明创造。
4. 利用本单位的物质技术条件完成发明创造， 其专利权依据合同约定。

## 5.  数据通信基础

### 5.1. 数据通信系统的模型

#### 5.1.1. 通信术语

**模拟信号**：是在一段连续的时间间隔内，其代表信息的特征量可以在任意瞬间呈现为任意数值的信号。

**数字信号**：是信息用若干个明确定义的离散值表示的时间离散信号。

**码元**：单位时间内信号波形的变换次数。

#### 5.1.2. 数据通信系统的模型

![](https://lgx_248920070.gitee.io/lgxblog/img/202209051631344.png)

![](https://lgx_248920070.gitee.io/lgxblog/img/202209051638777.jpg)

![](https://lgx_248920070.gitee.io/lgxblog/img/202209051746549.jpg)



**奈奎斯特定理**（在无噪声干扰的信道上传输） 数据速率：
$$B = 2W$$
$W$ ：信道带宽；单位是（$Hz$）

$B$：最大码元速率（波特率）

极限数据速率 $R$ （单位 $bps$）：

$$R=B*\log_2N$$

**香农定理**（在有噪声干扰的信道上传输） 数据速率：

$$C=W\log_2(1+S/N)$$

$C$：极限数据速率（$bps$）

$W$ ：信道带宽；单位是（$Hz$）

使用香农定理时，由于 $S/N$ （信噪比）的比率通常过大，因此通常使用**分贝数** $dB$ 来表示。

**分贝与信噪比的关系**：

$$dB=10\log_{10}{(S/N)}$$

例如，当 $S/N=1000$ 时，分贝表示是 30 $dB$ ，带宽为 3$khz$，此时极限速率 $C$ 为：

$$C=3000*\log{2}{(1+1000)}=3000*9.97=30bps$$

### 5.2. 调制技术-模拟信道传送数字数据

| 调制技术        | 说明                                                         | 码元种类 | 比特位 | 特点                                                       |
| --------------- | ------------------------------------------------------------ | -------- | ------ | ---------------------------------------------------------- |
| ASK（幅移键控） | 用恒定的载波振幅值表示一个数，（通常是1），无载波表示另一个数。 | 2        | 1      | 实现简单，但抗干扰性差，效率低（典型数据率为1200bps）      |
| FSK（频移键控） | 由载波频率（$f_e$）附近的两个频率（$f_1$、$f_2$）表示两个不同值，$f_e$恰好为中值。 | 2        | 1      | 抗干扰性较ASK更强，但占用带宽较大，（典型数据率为1200bps） |
| PSK（相移键控） | 用载波的相位偏移来表示数据值                                 | 2        | 2      | 抗干扰性最好，而且相位的变化可以作为定时信息来同步时钟。   |
| 4DPSK           | 四差分相移键控                                               | 4        | 2      | 每90 °表示一种状态。                                       |
| QPSK            | 正交相移键控                                                 | 4        | 2      | 每90 °表示一种状态。                                       |
| MQAM            | 正交幅度调制                                                 |          |        | 相位和幅度联合键控的调制方式。                             |

![](https://lgx_248920070.gitee.io/lgxblog/img/202209091441087.jpg)

### 5.3. 调制技术-数字信道传送模拟数据

PCM脉冲编码调制技术

- **采样**：每隔一定的时间间隔，取模拟信号的当前值作为样本。（奈奎斯特采样定律：采样频率大于模拟信号的最高频率的2倍）

- **量化**：用多少位的二进制值来表示这个样本。
- **编码**：把各个样本串接起来，用编码。

### 5.4. 数字编码与编码效率-基本编码

![](https://lgx_248920070.gitee.io/lgxblog/img/202209131053227.jpg)

**单极性码**：只有一个极性，正电平为0，零电平为1 ;

**极性码**：两个极性，正电平为0，负电平为1 ;

**双极性码**：零电平为0，正负电平交替翻转表示1，这种编码不能定时，需要引入**时钟**。

**归零码**：码元中间信号回归到零电平，正电平到零电平转换边为0，负电平到零电平的转换边为1 。这种码元自定时。

**不归零码**：码元中间信号不归零，1 表示电平翻转，0 不翻转。

**双相码**：低到高表示0，高到底表示1。这种编码抗干扰性好，实现自同步。

**曼彻斯特码**：**低到高**表示0，**高到底**表示1。相反亦可。码元中间电平转换既表示数据，又做定时信号。用于**以太网编码**，常用于**10M以太网**，编码效率为50%。

**差分曼彻斯特码**：每—位( bit ) 开始处是否有电平翻转，有电平翻转表示0，无电平翻转表示1。编码效率为50%。



### 5.5. 数字编码与编码效率

| 编码方案 | 说明                                      | 效率               | 典型应用                     |
| -------- | ----------------------------------------- | ------------------ | ---------------------------- |
| 4B/5B    | 每次对4位数据进行编码，将其转化为5位符号  | 1.25波特/位，即80% | 100Base-FX，100Base-TX，FDDI |
| 8B/10B   | 每次对8位数据进行编码，将其转化为10位符号 | 1.25波特/位，即80% | 千兆以太网                   |
| 8B/6T    | 8bit映射为6个三进制位                     | 0.75波特/位        | 100Base-T4                   |

### 5.6. 复用技术

多路复用技术是把多个低速信道组合成一个高速信道的技术。它可以有效地提高数据链路的利用率，从而使得一条高速的主干链路同时为多条低速的接入链路提供服务，也就是使得网络干线可以同时运载大量的语音和数据传输。

![](https://lgx_248920070.gitee.io/lgxblog/img/202209131314203.jpg)



**空分复用（SDM）**：让同一个频段在不同的空间内得到重复利用，称之为空分复用，比如在卫星通信中就使用该技术。

**频分多路复用（FDM）**：在同一物理连接上使用多个**不同频率**的模拟载波信号进行多路传输。

**时分多路复用（TDM）**：在同—物理连接的**不同时段**来传输不同的信号。

**波分多路复用（WDM）**： 在同—根**光纤中**同时传输两个或众多**不同波长光信号**的技术。

**码分多路复用（CDM）**：依靠**不同的编码**来区分各路原始信号的一种复用方式。

#### 5.6.1. 常见复用标准

| 名称       | 原理与组成                                                   | 应用场景                 |
| ---------- | ------------------------------------------------------------ | ------------------------ |
| E1载波     | 采用同步**时分复用**技术将**30个话音信道**（64K）和两个**控制信道**CHO，CH16（64K）复合在一条**2.048Mbps**的高速信道上 | 欧洲发起，除美，日外多用 |
| E2         | **8.488Mbps**                                                | 相当于 **4E1**           |
| E3         | **34.368Mbps**                                               | 相当于 **4E2**           |
| E4         | 139.264Mbps                                                  | 相当于 4E3               |
| T1载波     | 采用同步**时分复用**技术将**24个话音通路**复合在一条**1.544Mbps**的高速信道上 | **美国和日本**           |
| T2（DS2）  | 由4个T1时分复用构成，达到**6.312Mbps**                       | 美国                     |
| T3（DS3B） | 由**7个T2**时分复用构成，达到**44.736Mbps**                  | 美国                     |
| T4（DS4B） | 由6个T2时分复用构成，达到274.176Mbps                         | 美国                     |

### 5.7. 通信方式

![](https://lgx_248920070.gitee.io/lgxblog/img/202209131337240.jpg)

### 5.8. 差错控制

检错：检查出错误，不知道错误在哪。

纠错：检查出错误，知道错误是哪一位并加以纠正。

**码距**：一种编码两个码字间变化的二进制数字为码距。

**最小码距**： 一种编码中任意两个码字之间**最少变化的二进制位数**。



在一个码组内为了检测e个误码，要求最小码距应满足 d>=e+1

在一个码组内为了纠正e个误码，要求最小码距应满足 d>=2t+1

#### 5.8.1. 奇偶校验

检错码 = 信息字段 + 校验字段

添加 1 位校验码，使码字中 `1` 的个数为奇数，则为**奇校验**。

添加 1 位校验码，使码字中 `1` 的个数为偶数，则为**偶校验**。

设要传送比特信息为 `C1C2C3C4C5`，其中校验字段 `C6` 取值 “0”或“1”，经过编码以后变成六比特编码码字，其中校验位 `C6` 应满足下列关系：

$$C1 ⊕ C2 ⊕ C3 ⊕ C4 ⊕ C5 ⊕ C6 = 0$$

算式中的加法使模二加，上式的**右边等于零**称为**偶校验**，此时代表等式的左边含偶数个1；

上式的**右边等于一**称为**奇校验**，此时代表等式的左边含奇数个1；

#### 5.8.2. 海明校验

海明码校验位为$k$,信息位为$m$,则它们之间的关系应满足：

$$m+k+1<= 2^k$$

原始信息为 101101 ，确定海明码校验位长为：

$6+k+1<=2^k$，可得到 $k$ 为 4。

推导过程忽略。

#### 5.8.3. CRC校验

要计算CRC校验码，需根据CRC生成多项式进行。

例如：原始报文为 11001010101，其生成多项式为 $x^4+x^3+x+1$，如图：

![](https://lgx_248920070.gitee.io/lgxblog/img/202209141743044.jpg)

最后将0011填写到原始报文的后面。

步骤：

1. 原始信息后填 "0"，根据CRC生成多项式最高幂次填写，生成多项式为 $x^4+x^3+x+1$，所以在原始信息后填4个0。
2. 把生成多项式转换为二进制数表示形式，存在 x 幂次方则为1，不存在则为0。如 11011 就是根据 $x^4+x^3+x+1$ 与 x 幂次方进行计算。
3. 利用模2除法进行计算。实际上就是二进制的异或运算。余数不足则在前面添加足够位数的 0 来补全。

| 网络协议          | CRC位       | 应用点                     |
| ----------------- | ----------- | -------------------------- |
| HDLC              | CRC16/CRC32 | 除帧标志位外的全帧         |
| FR（帧中继）      | CRC16       | 除帧标志位外的全帧         |
| ATM               | CRC8        | 帧头校验                   |
| 以太网（802.3）   | CRC32       | 帧头（不含前导和帧起始符） |
| 令牌总线（802.4） | CRC32       | 帧头（不含前导和帧起始符） |
| 令牌环（802.5）   | CRC32       | 帧头（从帧控制字段到LLC）  |
| FDDI              | CRC32       | 帧头（从帧控制字段到INFO） |

## 6.  网络体系结构

### 6.1. 计算机网络的概念

定义：以能够相互共享资源的方式连接起来的独立的计算机系统的集合，其组成可分为软件、硬件及协议。

主要表现：

- 目的是实现计算机资源的共享。
- 分布在不同地理位置的多台独立的“ 自治计算机” 。
- 通信必须遵循共同的网络协议。

### 6.2. 网络的性能

![](https://lgx_248920070.gitee.io/lgxblog/img/202209151110673.jpg)

**速率（单位：b/s)**：单位时间内发送二进制数据( bit ) 流的多少。

**带宽（单位：b/s)**：表示信道能够承受最大的数据传输速率。

**吞吐率（单位：b/s)**：实际通过网络的通信量。

**时延**：又称延时，有如下种类：**发送时延（传输时延）**、**传播时延**、**处理时延**、**排队时延**等…

发送时延＝数据帧长度/信道带宽
传播时延＝信道长度（距离）/电磁波在信道上的传播速率

对于传播时延：

电缆介质为200km/ms=200m/us，具体延时时间与两地距离有关系。卫星信号的传播延迟为270ms。

### 6.3. 网络协议

定义：为网络数据交换而制定的规则、约定与标准称之为网络协议。计算机网络各节点之间必须遵守事先预定好的规则交换数据和控制信息，这些规则精确定义了所交换数据的格式和时序。

三要素：**语法、语义、时序**

语法规定了数据包的格式，语义定义数据如何处理。时序定义数据处理的顺序。
注： 通信双方对等层次上所对应的网络协议必须一致。

### 6.4. OSI模型层次结构

![](https://lgx_248920070.gitee.io/lgxblog/img/202209151128301.jpg)

**物理层**： 为数据通信提供物理通路、透明的二进制数据流（ 比特流） 传输、定义机械、电气特性和接口。

**数据链路层**： 数据链路的链接及释放， 流量控制、构成链路数据单元， 差错检测与恢复。点对点传送以数据帧为单位的信息。

**网络层**： 实现路由路径选择和网络连接的激活及终止， 网络连接的多路复用， 检错、排序、流量控制、服务选择

**传输层**： 提供**端与端**之间可靠透明的数据传输， 传输连接的建立及释放， 多路复用与分割， 差错控制及恢复， 分段、重组、排序， 流量控制。

**会话层**： 会话链接到传输链接的映射、会话链接的恢复与释放， 对会话参数进行协商、服务选择、活动管理、令牌管理。

**表示层**： 通信系统之间数据的表示方式， 如ASCII 码。数据语法转换、数据加密与压缩、连接管理。

**应用层**： 提供用户应用程序所需的应用接口和需要的协议及功能。

目前， OSI 模型只作为理论进行研究，实际使用的为 TCP/IP 模型。

### 6.5. 数据封装与解封装

![](https://lgx_248920070.gitee.io/lgxblog/img/202209151137790.jpg)

### 6.6. OSI模型-服务访问点

![](https://lgx_248920070.gitee.io/lgxblog/img/202209151423703.jpg)

### 6.7. TCP/IP体系结构

![](https://lgx_248920070.gitee.io/lgxblog/img/202209151436321.jpg)

## 7. 局域网技术

### 7.1. 局域网概念

局域网( LAN ) 是指**有限区域**内（ 例如办公室或楼层） 的**多台计算机**通过**传输介质互联**， 所组成的封闭网络以实现**数据通信**及**资源共享**的目的。
**常用的介质**： 双绞线、同轴电缆、光纤、无线等。
**典型特点**： 覆盖的地理范围小（ 几米到几公里），具有**较高的数据传输速率**和**较低的时延**。

#### 7.1.1. 局域网拓扑结构

**总线型**： 以广播形式发送数据， 所有站点都能收到数据。所有站点同时发送数据时会发生冲突，主要传输介质为同轴电缆。

**星形**： 所有站点均连接在中心节点(HUB ) 上， 所有的数据交互均要通过中心节点， —个中心节点容易产生单点故障， 所以通常星形拓扑中的中心节点会有—个备份。

**环形**： 由一系列首尾相连的中继器组成， 每个中继器连接一个站点。需要有某种访问逻辑来控制各个站点的发送顺序， 最常用传输介质为双绞线。轻负载时效率低， 重负载时利用率高。

**树形**： 将多级中心节点(HUB ) 连接起来以扩大网络的规模， 数据可以延链路传输至链路上的任何一个站点。

### 7.2. IEEE 802标准

| 局域网标准      | 描述                                                         |
| --------------- | ------------------------------------------------------------ |
| IEEE 802.1A     | 局域网体系结构，并定义接口原语                               |
| IEEE 802.1B     | 寻址、网间互连和网络管理                                     |
| IEEE 802.2      | 描述逻辑链路控制( LLC )协议，提供OSI数据链路层的上部子层功能，以及介质接入控制( MAC )子层与LLC子层协议间的一致接口 |
| **IEEE 802.3**  | **描述CSMA/CD介质接入控制方法和物理层技术规范**              |
| IEEE 802.4      | 描述令牌总线网标准                                           |
| IEEE 802.5      | 描述令牌环网标准                                             |
| IEEE 802.6      | 描述城域网DQDB标准                                           |
| IEEE 802.7      | 描述宽带局域网技术                                           |
| IEEE 802.8      | 描述光纤局域网技术                                           |
| IEEE 802.9      | 描述综合话音/数据局域网( IVD LAN )标准                       |
| IEEE 802.10     | 描述可互操作局域网安全标准( SILS)，定义提供局域网互连的安全机制 |
| **IEEE 802.11** | **描述无线局域网标准**                                       |
| IEEE 802.12     | 描述交换式局域网标准，定义100Mb/s高速以太网按需优先的介质接入控制协议100VG-ANYLAN |
| IEEE 802.14     | 描述交互式电视网(包括Cable Modem )                           |

### 7.3. 以太网技术-CSMA/CD协议

**载波监听多路访问/冲突检测**：发送数据前先监听信道是否空闲，若空闲，则立即发送数据。在发送数据时，边发送边继续监听。若监听到冲突，则立即停止发送数据，等待一段随机时间再重新尝试。

CSMA/CD 协议避免冲突的过程：

1. **数据发送前监听**
2. **数据发送时边发边监听**
3. **发现冲突立即停发数据**
4. **数据重发**

监听算法：

- **非坚持型监听算法**：信道空闲立刻发送，信道繁忙时，**等待随机时间$t$后再发送**。特点：信道利用率更高，由于随机时间后发送，减少了冲突的概率。可能会出现增加发送时延的问题。
- **1-坚持型监听算法**：信道空闲立刻发送，信道繁忙时**持续监听**，直到**信道空闲后再发送**。特点：有利于抢占信道。可能会导致多次冲突从而降低性能。
- **P-坚持型监听算法**：信道空闲时，以**概率P去发送数据**，以**（1-P）的概率去推迟发送数据**。特点：P概率取值比较困难。

冲突检测：

以太网的端到端往返时延$2t$称为**争用期**，或**碰撞窗口**。

**最短帧长计算公式**：

$$传输时延>=2*传播时延$$

发生冲突后，立刻停止发送，并对信息进行重传。

数据重发：

随机延时重发----截断二进制指数退避算法：

1. 确定基本退避时间；
2. 从离散的整数集合$[0,1,...,(2^{n-1})]$中随机取出一个数，记为$r$。重传应推后的时间为$r$倍的争用期。参数$k$按照$k=Min[重传次数,10]$计算。
3. 当重传次数到达16次仍不能成功时，就丢弃该帧，并向高层报告。

### 7.4. 以太网技术-MAC地址

![](https://lgx_248920070.gitee.io/lgxblog/img/202209192325283.jpg)

MAC地址是由48位（6个字节）组成，对于前8位的最后一位，如果为0，则为**单播地址**，如果为1，则为**组播地址**。

MAC地址通常表示为12个16进制数，组合起来刚好为48位。

### 7.5. 以太网技术-以太网V2帧格式

![](https://lgx_248920070.gitee.io/lgxblog/img/202209192336489.jpg)

**前同步码**：7个字节，用户使接收端进入同步状态。

**帧开始定界符**：1个字节，标识信息帧开始。

**目的地址，源地址**：目的和源的MAC地址。占用6个字节。

**类型**：表示上层协议，OX0800表示上层协议为IP协议； OX8137表示上层协议为IPX协议。占用两个字节。

**数据**：IP数据报，占用46~1500字节。

**FCS帧校验字段**：采用CRC校验。占用4字节。

MAC帧（以太网帧） **最小帧长为64** 字节， **最大帧长1518**字节。

### 7.6. 以太网技术-网络传输介质

![](https://lgx_248920070.gitee.io/lgxblog/img/202209201651026.jpg)

双绞线分为**非屏蔽双绞线UTP**，**屏蔽双绞线STP** 。屏蔽双绞线抗电磁干扰能力更强，但传输距离更短。

**T568A**：白绿绿白橙蓝白蓝橙白棕棕

**T568B**：白橙橙白绿蓝白蓝绿白棕棕

区别为 1和3，2和6做了调换。

目前网络设备均能自动适应这两种标准，并能自动转换成合适的线序，所以一般只采用T568B的接线方式。

![](https://lgx_248920070.gitee.io/lgxblog/img/202209201933941.jpg)

| 项目     | 距离 | 速度 | 直径 | 端接 | 造价 | 光源       |
| -------- | ---- | ---- | ---- | ---- | ---- | ---------- |
| 单模光纤 | 长   | 快   | 小   | 较难 | 高   | 激光       |
| 多模光纤 | 短   | 慢   | 大   | 较易 | 低   | 发光二极管 |

### 7.7. 以太网技术-以太网命名规则

以太网命名规则：

$$N + 信号 + 传输介质$$

N：以兆为单位数据传输速率。如10，100，1000Mb/s

信号：基带还是宽带。

- **Base**：基带（数字信道）
- **Board**：宽带（模拟信道）

传输介质：标识介质的种类。

- **T**：非屏蔽双绞线 **UTP**。
- **F**：光纤（可以是单模或者是多模）。
- **C**：屏蔽双绞线 **STP**。
- **数字**：为同轴电缆及电缆长度（10base5，10base2）。
- **LX**：长距离光模块（一般指**单模光纤**）。
- **SX**：短距离光模块（一般指**多模光纤**）。
- **CX**：**双绞线**。
- **LH**：一般指超长距离光模块。

### 7.8. 以太网技术-快速以太网

- 技术特点

  - 100Mbps
  - 相同的帧格式
  - 半双工/全双工
  - 100Base-T
- 传输介质标准
  - 100Base-TX：使用2对**5类UTP** , 一对用于接收， 一对用千发送。
  - 100Base-FX：使用光纤，两芯单模或者多模光纤。
  - 100Base-T4：使用3对**4类UTP** , 其中一对用于碰撞检测。
  - 100Base-T2：由100Base-T4升级而来。

### 7.9. 以太网技术-千兆以太网

- 技术特点

  - 1000Mbps
  - 相同的帧格式
  - 半双工/全双工
- 传输介质标准
  - 1000Base-T：使用4对**5类UTP** , 最大段长100米( **IEEE802.3ab** )
  - 1000Base-CX：使用2对**STP** , 传输长度25米( IEEE802.3z）
  - 1000Base-LX：使用多模光纤传输距离550米， 使用单模光纤传输距离为5干米( I EEE802.3z )
  - 1000Base-SX：使用多模光纤传输距离550米（IEEE802 . 3z )

### 7.10. 以太网技术-万兆以太网

- 技术特点

  - 10000Mbps
  - 相同的帧格式
  - 全双工
- 传输介质标准
  - 局域网物理层
  - 可选的广域网物理层

### 7.11. 以太网技术-冲突域和广播域

**冲突域**： 连接在同一传输介质上的所有工作站的集合。

**广播域**： 指接收同样广播消息的节点的集合。

|        | 分割冲突域 | 分割广播域 |
| ------ | ---------- | ---------- |
| 集线器 | ✗          | ✗          |
| 交换机 | ✓          | ✗          |
| 路由器 | ✓          | ✓          |

### 7.12. 以太网技术-交换式以太网

交换式以太网是以**交换式集线器**或者**交换机**为中心构建的**星形拓扑**结构网络，利用“ **端口/MAC地址映射表**” 进行数据交换。

**减少冲突**： 交换机将冲突隔绝在每—个端口（即**每个端口都是—个冲突域**），避免了冲突的扩散。

**提升带宽**：接入交换机的每个节点都可以使用全部的带宽，而不是各个节点共享带宽。

- 广播：如果目标地址在MAC地址表中没有，交换机就向除接收到该数据帧的端口外的其他所有端口广播该数据帧。
- 学习：MAC地址表是交换机通过学习接收的数据帧的源MAC地址来形成的。
- 转发：交换机根据MAC地址表**单播**转发数据帧。
- 更新：交换机MAC地址表的老化时间是**300秒**。

交换机如果发现一个帧的入端和MAC地址表中源MAC地址的所在端口不同，交换机将MAC地址重新学习到新的端口，

### 7.13. 以太网技术-堆叠和级联

- 级联可通过一根双绞线在任何网络设备厂家的交换机之间进行
- 级联可以使用普通端级联也可使用uplink端口级联
- 堆叠只有在自己厂家的设备之间进行
- 堆叠需要专用的堆叠模块和堆叠线缆
- 堆叠后的所有交换机可视为一个整体交换要来进行管理

### 7.14. VLAN

VLAN 技术解决了局域网互联时无法限制广播的问题， 每个VLAN一个**广播域**，不同VLAN之间不能通信， 如果需要通信，需要增加三层设备。

### 7.15. IEEE 802.1Q

![](https://lgx_248920070.gitee.io/lgxblog/img/202209212039169.jpg)

其中，VLANID占了12位，$2^{12}=4096$，0和4096都是不可使用的，实际可用的为4094个VLAN。

**VLAN划分方法**：

- **基于端口的划分**：静态VLAN
- **基于MAC地址的划分**：动态VLAN
- **基于网络层协议的划分**：动态VLAN
- **基于子网的划分**：动态VLAN
- **基于策略的划分**：如基于MAC+端口进行划分VLAN。动态VLAN

**以太网端口的类型**：

- **Access 端口**：主要用于连接终端，特点是**仅允许一个VLAN**的帧通过。
- **Trunk 端口**：主要用于连接其它交换机端口,特点是**允许多个VLAN**通过，并且**除了缺省VLAN**外,其它VLAN都**带标签通过Trunk端口**。当VLAN为1（**缺省VLAN**）时，通过Trunk端口进行转发时，会把标签去除掉，另外一个交换机收到之后，会打上PVID（**缺省VLAN**），在交换机内部进行转发。
- **Hybrid 端口**：即可以用于连接终端，又可以连接其它交换机、路由器设备，特点是允许一个或多个VLAN的帧通过，并且**可以选择**是**带标签还是不带标签**。

### 7.16. VLAN注册协议-GVRP协议

手工配置的VLAN称为**静态VLAN**，通过GVRP协议创建的VLAN称为**动态VLAN**。GVRP有三种注册模式，不同的模式对静态VLAN和动态VLAN的处理方式也不同。GVRP 的三种注册模式分别为：

- **Normal 模式**：**允许动态VLAN**在端口上注册。**同时发送动态和静态VLAN**的声明信息。
- **Fixed 模式**：**不允许动态VLAN**在端口上注册。**只发送静态VLAN**的声明信息。
- **Forbidden 模式**：**不允许动态VLAN**在端口上注册。**只发送VLAN1**的声明信息。

### 7.17. 生成树协议-STP

> **广播风暴**（broadcast storm）简单的讲是指当广播数据充斥网络无法处理，并占用大量网络带宽，导致正常业务不能运行，甚至彻底瘫痪，这就发生了“广播风暴”。一个数据帧或包被传输到本地网段 （由广播域定义）上的每个节点就是广播；由于网络拓扑的设计和连接问题，或其他原因导致广播在网段内大量复制，传播数据帧，导致网络性能下降，甚至网络瘫痪，这就是广播风暴。

生成树协议(Spanning Tree Protocol) ：

- 在逻辑上断开环路，防止广播风暴的产生。
- 当线路出现故障，断开的接口被激活，恢复通信，起到线路备份的作用。

#### 7.17.1. 生成树协议算法 

生成树协议将环形网络生成无环拓扑的步骤：

<center>选择根网桥-->选择根端口-->选择指定端口</center>



##### 选择根网桥

**网桥ID**是唯一的，交换机之间选择**桥ID（BID）**值最小的交换机为网络中的根网桥。

**网桥ID**组成：**网桥优先级**（2字节）+**网桥的MAC地址**（6字节）

网桥优先级取值范围：**0~65535**，默认值为**32768**，如果需要调整，必须为**4096的倍数**。

优先级值越小优先级越高， 优先级高的的为根桥。如果优先级相同，选取MAC地址最小的为根网桥。

##### 选择根端口

在**非根网桥上**选取一个**到根网桥最近的端口**。选择步骤：

1. 本端口到**根网桥的路径开销**最低。**带宽越大，成本越小。**

2. 路径成本相同，选择直连的**网桥ID最小**的端口。

3. **网桥ID最小**的端口相同，选择直连的**端口ID最小**的端口。

   <center>端口ID =（端口优先级+端口编号）</center>

端口优先级：默认为**128**，如果需要调整，必须为**16的倍数**。越小优先级越高。

端口编号：端口实际的编号。

##### 选择指定端口

**根网桥所有端口都是指定端口**。非根网桥上选择步骤：

1. 本端口**所在网桥到根网桥路径开销最小**。
2. 本端口**所在的网桥的ID**较小。
3. 本**端口ID值**较小。

端口开销规定：10G端口开销为2，1000M端口开销为4，100M端口开销为19，10M端口开销为100

##### 生成树协议端口状态

收敛时间为**50s**

![](https://lgx_248920070.gitee.io/lgxblog/img/202209271004535.jpg)

- **阻塞（Blocking）**：仅监听BPDU, 不转发数据帧，也不学习接受帧的MAC地址，延时20s，防止启动交换机过程中产生交换环路。
- **监听（Listening）**：相互学习BPDU的信息，以便交换机可以学习网络中其他交换机的信息，延时15s。此时不学习MAC帧的地址不转发数据帧。
- **学习（Learning）**：处理学习到的BPDU信息，开始计算生成树协议。 学习MAC地址，建立地址表，但不转发数据帧，该状态维持15s。
- **转发（Forwarding）**：可以发送或监听BPDU（ 用桥协议数据单元来传递交换机之间的生成树协议的信息），可以转发数据帧。
- **禁用**：端口不参与生成树协议，不监听也不发送BPDU，也不转发数据帧。

### 7.18. 快速生成树协议-RSTP

**快速生成树协议RTSP** ( Rapid Spanning Tree Protocol ) **IEEE802.1w**：由IEEE802.1d发展而来。是优化版的STP ，大大缩短了端口进入转发状态的延时，从而缩短了网络最终达到拓扑稳定所需要的时间。

- 端口状态只有三个：**丢弃**（将STP中的禁用，监听，阻塞合并而来），**学习**，**转发**。
- 端口角色变为四个：根端口，指定端口，Alternate端口（根端口的替代），Backup端口（指定端口的替代）。

RSTP提出了快速收敛机制：

- **边缘端口机制**：不参与生成树协议计算的端口。一般是**与终端相连**。一般情况下需要网络管理员手动指定。
- **根端口快速切换机制**
- **指定端口快速切换机制**

### 7.19. 多生成树协议-MSTP

多生成树MTSP（Multiple Spanning Tree Protocol）：基于实例计算出多颗生成树，实例间实现负载均衡。

先划分实例，之后再映射VLAN，在实例中去找根网桥，根端口，指定端口实现的负载均衡。

不同实例间使用的是不同的根网桥，根端口。

### 7.20. 以太网通道|链路聚合|端口聚合|ETH-Trunk

将**多条物理链路捆绑成一条逻辑链路**，实现**负载均衡**、提高**带宽容错**（当一条链路失效时，使用其他链路进行通信）。

以太网通道最多可以捆绑8条物理链路，其中物理链路可以是双绞线，也可以是光纤连接。

**以太网通道捆绑规则**：

- 参加捆绑的端口属于**同一个VLAN**。
- 如果端口配置的是中继模式，那么应该在链路两端将通道中的所有端口配置成**相同的中继模式**。
- 所有参与捆绑的端口的**物理参数设置必须相同**。应该有同样的速度和半双工或者全双工配置。

协议：

PAGP（端口聚合协议）：Cisco私有协议

LACP（链路聚合控制协议）：IEEE802.3ad

### 7.21. 无线局域网

无线数据网络种类：无线个人网、无线局域网、无线城域网和无线广域网

| 种类       | 标准                      | 典型应用             | 覆盖范围 |
| ---------- | ------------------------- | -------------------- | -------- |
| 无线个人网 | IEEE 802.15               | 蓝牙                 | <=10m    |
| 无线局域网 | IEEE 802.11               | 无线企业网           | <=100m   |
| 无线城域网 | IEEE 802.16               | 主要用于Internet访问 | 2~10KM   |
| 无线广域网 | IEEE 802.20&3蜂窝移动通信 | 主要用于Internet访问 |          |

无线局域网的优点：

- 灵活性和移动性
- 安装便捷
- 易于进行网络规划和调整
- 故障定位容易
- 易于扩展

无线局域网的两种拓扑结构：

- **Infrastructure结构**（基础设置网络）：所有无线终端通过AP访问骨干网络。类似传统有线星型拓扑方案。
- **Ad Hoc结构**（特殊网络）：该方式是点对点的网络，以无线网卡连接的终端设备可以互相通信。

WLAN标准：

| 标准     | 运行频段     | 主要技术      | 数据速率     |
| -------- | ------------ | ------------- | ------------ |
| 802.11   | 2.4Ghz       | 扩频通信技术  | 1Mbps和2Mbps |
| 802.11b  | 2.4Ghz       | HR-DSSS 技术  | 11Mbps       |
| 802.11a  | 5Ghz         | OFDM 调制技术 | 54Mbps       |
| 802.11g  | 2.4Ghz       | OFDM 调制技术 | 54Mbps       |
| 802.11n  | 2.4Ghz和5Ghz | MINO和OFDM    | 600Mbps      |
| 802.11ac | 5Ghz         | MINO和OFDM    | 1Gbps        |
| 802.11ax | 2.4Ghz和5Ghz | MINO和OFDM    | 11Gbps       |

扩频通信技术是将要发送的信息扩展到一个很宽的频带上，以很宽的信道传送信息，抗干扰能力，抗衰落能力较强，抗阻塞能力也强。包括跳频扩频（FHSS）和直接序列扩频（DSSS）。

![](https://lgx_248920070.gitee.io/lgxblog/img/202209281523754.jpg)



隐蔽站问题：

![](https://lgx_248920070.gitee.io/lgxblog/img/202209281701670.jpg)

其中B 在C的无线电波范围内，但A不在C的无线电波范围内。 此时C 正在向B传送数据，而A也试图向B传送数据。此时，A不能够监听到B 正在忙（因为A在监听信道的时候什么也听不到，所以它会错误的认为此时可以向B传送数据了）。如果A向B传送数据，则将导致冲突。这就是隐蔽站问题。其中C是A的隐蔽站。

暴露站问题：

![](https://lgx_248920070.gitee.io/lgxblog/img/202209291526443.jpg)

其中C在B的无线电波范围内，但D不在B的无线电波范围内。此时B正在传送数据（向A进行传送），而C希望给D发送数据，但是错误地认为该传送过程将会失败，因为C会监听到—次传输，所以它会错误地认为此时不能向D发送数据，这就是暴露站问题。

#### 7.21.1. IEEE802.11 MAC 层协议（CSMA/CA）

因为存在**隐蔽站**和**暴露站**问题，无线局域网不适用CSMA/CD协议，只能使用改进CSMA协议。

CSMA/CA 基本操作过程如下：

- 如果有一个站点要发送数据并且监听到信道忙，则产生一个随机数设置自己的后退计时器并且继续监听。
- 监听到信道空闲后等待 IFS 时间，然后开始计数。 最先计数完成的站点开始发送数据。 
- 其他站点监听到有新的站点开始发送数据后暂停计数，在新的站点数据发送完成后在等待一个IFS 时间继续计数，知道计数完成开始发送数据。

MAC子层：

![](https://lgx_248920070.gitee.io/lgxblog/img/202209291544012.jpg)

- DCF子层在每—个结点使用CSMA机制的分布式接入算法，让每个站通过争用信道来获取发送权。 

- PCF子层使用集中控制的接入算法将发送数据权轮流交给每个站点从而避免了碰撞的产生。（可选）

#### 7.21.2. WLAN安全性

提升WLAN安全性的手段：

- 更改默认设置
- 更新AP的Firmware 
- 屏蔽SSID广播
- 加密和认证
- MAC 地址过滤

#### 7.21.3. 无线局域网组网

胖AP（FAT）：一般指无线路由器，多用于家庭、酒店办公场所等小型网络，功能较全，自带操作系统，设置简单，能实现接入、认证、路由、VPN、地址翻译甚至防火墙功能。

瘦AP（FIT）：去掉路由、DNS、DHCP 服务器等诸多额外的功能， 仅保留无线接入的部分。不能独立工作，设置需要通过专用AC（AP控制器）来完成。

![](https://lgx_248920070.gitee.io/lgxblog/img/202209291604619.jpg)

### 7.22. 综合布线技术？需补充

## 8. 广域网与接入网技术

### 8.1. 广域网交换方式

- 电路交换：通信开始之前，主呼叫和被呼叫之间建立连接，之后建立通信，期间**独占整个链路**，结束通信时释放链路。电路交换是面向连接的。

- 报文交换：结点把要发送的信息组织成一个报文（数据包），该报文中含有目标结点的地址，每一个节点接收整个报文并检查目标地址，然后根据网络情况，在适当的时刻向下一个节点转发。

- **分组交换**：分为**数据报**和**虚电路**。目前虚电路已经被淘汰。

![](https://lgx_248920070.gitee.io/lgxblog/img/202209291728679.jpg)

**虚电路**：在网络的源主机和目标主机建立一条逻辑通道，所有报文沿着逻辑电路传输数据。传输完毕后，需要释放虚电路。

**数据报**：数据包服务类似于邮政系统的信件投递，每个分组都携带完整的源和目的节点的地址信息，独立进行传输，每当经过一个中间节点时，都要根据目标地址和网络的状态，去选择一条最佳的输出路径。

| 对比                       | 虚电路服务                                     | 数据报服务                                 |
| -------------------------- | ---------------------------------------------- | ------------------------------------------ |
| 思路                       | 可靠通信由网络保障                             | 可靠通信由**用户主机**保障                 |
| 连接的建立                 | 必须有                                         | 不需要                                     |
| 终点地址                   | 仅在连接建立阶段使用，每个分组使用短的虚电路号 | 每个分组都有重点的完整地址                 |
| 分组的转发                 | 属于同一条虚电路的分组均按照同一路由进行转发   | 每个分组独立选择路由进行转发               |
| 当节点出现故障时           | 所有通过出故障节点的虚电路都不能工作           | 出故障的节点可能丢失分组，一些路由发生变化 |
| 分组的顺序                 | 总是按发送顺序到达终点                         | 不一定按发送顺序到达终点                   |
| 端到端的差错处理和流量控制 | 可以由网络负责，可以由用户主机负责             | 用户主机负责                               |

常见广域网协议：

- X.25是一个使用电话或者ISDN设备作为网络硬件设备来架构广域网的ITU-T网络协议。它的物理层，数据链路层和网络层都是按照OSI体系模型来架构的。通过建立虚电路，实现可靠交付。
- 帧中继（Frame Relay）在第二层建立虚拟电路，用帧方式承载数据业务，第三层被简化。并且**帧中继只做检错，不重传， 没有滑动窗口式的流控机制，只有拥塞控制，把复杂的检错交给高层处理**，因此适合突发性业务。在虚连接中，用数据链路连接标识（DLCI）来表示该网络中的虚电路。
- ATM异步传输网络，采用面向连接的传输方式，将数据分割成固定长度的信元(53B) ,通过异步时分复用技术，在虚连接上实现快速交换的技术。ATIM的典型数据速率为155Mbps。

### 8.2. 流量与差错控制

**没有出错的状况**：

- **停等协议**： 发送站发送—帧，然后等待应答信号后再发送下—帧。接收站每收到—帧都要回—个**应答信号ACK** ， 表示愿意接受下—帧，如果接受站不发送信号则发送站必须等待。

- **滑动窗口协议**：如果接收端维持能容纳W个帧的缓冲区（ 即**窗口大小为W** ) ，那么发送端可以连续发送W个帧而不必等待应答信号，但是在接到接收端的应答信号之前，滑动窗口不滑动。接收端收到一个帧时，就发送一个应答信号，并把滑动窗口滑动到 $i=W-i+1$的位置，表明 i 之前的已正确接收，期待接收后续W个帧。

**出错的状况，需要进行差错控制**：

- **停等ARQ协议**：发送站发送一帧必须**等待应答信号ACK**，收到信号后才能发送下一帧；如果**收到否定应答信号NAK后重发**该帧；如果在一定时间内未收到应答信号必须重发。

- **选择重发ARQ**：只重发出错的帧，后面的帧被缓存。这种协议**窗口大小的最大值**应为**帧编号数的一半**

  $$W_发=W_收<=2^{k-1}$$

- **后退N帧ARQ**：哪一帧出错，这一帧之前的发过的帧都要进行重发。窗口大小为

  $$W<=2^{k}-1$$

### 8.3. HDLC

HDLC是一种**面向比特的同步数据链路控制协议**。

HDLC也是思科路由器上默认的wan口封装协议，是**思科私有协议**。

HDLC帧格式：

![](https://lgx_248920070.gitee.io/lgxblog/img/202209301530428.jpg)

在HDLC的帧结构中，若在两个标志字段之间的比特串中，碰巧出现了和标志字段F（01111110）一样的比特组合，那么就会误认为是帧的边界。为了避免出现这种情况，HDLC采用零比特填充法使一帧中两个F字段之间不会出现6个连续1。

每当发现5个连续1时，就将这5个连续1后的一个0删除，以还原成原来的比特流。这样就保证了在所传送的比特流中，不管出现什么样的比特组合，也不至于引起帧边界的判断错误。

![](https://lgx_248920070.gitee.io/lgxblog/img/202209301550398.jpg)

HDLC定义了三种帧：信息帧（I帧）、管理帧(S帧)、无编号帧（U帧），其中控制字段第一位或者前两位用于区别三种不同的帧（I帧控制字段第一位为0，S帧前两位为01，U帧前两位为11）

管理帧（S帧）不包含信息字段，它的第三、四位为管理帧（S帧）类型编码，共有四种不同的编码：

- 00-接受就绪（RR）
- 01-拒绝（REJ）
- 10-接受未就绪（RNR）
- 11-选择拒绝（SREJ）

### 8.4. PPP

点对点协议(Point to Point Protocol)： 缩写为PPP。面向**字符**，是TCP/IP 网络协议包的—个成员。通过在点对点的串行链路上封装数据包，并将HDLC（高级数据链路协议） 作为封装数据包的基础的点对点协议。他提供了—整套协议框架来解决链路建立、维护、拆除、上层协议协商和认证等问题。最常见应用为 **PPPOE**。

认证协议分为两种：

- PAP （ 密码认证协议） ： PAP 在网络上传送未加密的ASCII密码， 因此被认为是不安全的。

- CHAP （ 挑战式握手认证协议）：通过三次握手周期性的校验对端的身份，在初始链路建立时完成，**由主验证方先发送验证的请求**。可以在链路建立之后的任何时间重复进行。三次握手的过程：
  - 主验证方向被验证方发送**主机名+随机报文**。
  - 被验证方将密码，用户名，随机报文做一个MD5运算。得到128位摘要值。被验证方发送**主机名+加密后报文**给被验证方。
  - 主验证方验证，如果匹配则认证正常。

### 8.5. 常见接入网技术-SONET/SDH

| SONET信号       | 比特率/Mbps | SDH信号 |
| --------------- | ----------- | ------- |
| STS-1和OC-1     | 51.840      |         |
| STS-3和OC-3     | 155.520     | STM-1   |
| STS-12和OC-12   | 622.080     | STM-4   |
| STS-48和OC-48   | 2448.320    | STM-16  |
| STS-192和OC-192 | 9953.280    | STM-64  |
| STS-768和OC-768 | 39813120    | STM-256 |

### 8.6. 常见接入网技术-ISDN和xDSL

**ISDN 综合业务数字网**：是一个数字电话网络国际标准，—种典型的电路交换网络体统，采用时分多路复用技术。通过普通的铜缆及更高的速率和质量传输语音和数据， 俗称“—线通” 。

ISDN 分为窄带和宽带两种：

窄带ISDN：有基本速率（2B+D，144kbps）和一次群速率（30B+D，2Mbps）两种。

宽带ISDN：未普及，忽略。

**xDSL**：各种DSL 数字用户总线的总称，基千普通电话线采用频分复用技术的宽带接入技术，X 表示字符或字符串，根据采用的调制方式不同，获得不同的信号传输速率、传输距离、上行下行信道的不同对称性。

| XDSL  | 对称性 | 下行带宽             | 上行带宽             |
| ----- | ------ | -------------------- | -------------------- |
| ADSL  | 非对称 | 8Mbps                | 640kbps~1Mbps        |
| HDSL  | 对称   | 1.544Mbps，2.048Mbps | 1.544Mbps，2.048Mbps |
| SDSL  | 对称   | 2.3Mbps              | 2.3Mbps              |
| VDSL  | 非对称 | 55Mbps               | 19.2Mbps             |
| RADSL | 非对称 | 8Mbps                | 640kbps~1Mbps        |

### 8.7. 常见接入网技术-HFC

HFC（混合的光纤同轴电缆），综合运用了模拟和数字传输技术、同轴和光纤技术的宽带接入网络， 它由**光纤干线网**和**同轴分配网**组成。

在原有CATV网络基础上进行双向改造：

- 干线部分：光传输系统代替CATV中的同轴电缆
- 用户分配网：仍保留同轴电缆网络结构，但放大器改成双向的

可提供业务：

- 保留原有CATV单向电视广播业务
- 利用剩余频带提供宽带数据业务

### 8.8. 常见接入网技术-光纤接入网

有源接入：典型的设备主要是基于SDH的多业务传送平台、基于以太网或ATM的多业务接入平台等。这种技术作为**有源设备仍然无法完全摆脱电磁干扰和雷电影响**，以及**有源设备固有的维护问题**。

无源光网络（PON）：

PON由**光线路终端**（OLT）、**光分配网络**（ODN）、**光网络单元**（ONU）组成。

![](https://lgx_248920070.gitee.io/lgxblog/img/202210132323994.jpg)

根据ONU的位置，又分为几种：

- FTTC : ( Fiber To Zhe Curb ) 光纤到路边
- FTTZ : ( Fiber To Zhe Zone ) 光纤到小区。
- FTTB : ( Fiber To Zhe Building ) 光纤到大楼。
- FTTH : ( Fiber To Zhe Home ) 光纤到用户， 需要光电转换器。

采用**点到多点**模式，其**下行采用广播方式**、上行采用**TDMA时分多址方式**，可以灵活地组成树型、星型、总线型等拓朴结构（**典型结构为树型**），主要特征是ODN全部采用无源光器件组成，避免了有源设备的电磁干扰和雷电影响，减少了线路和外部设备的故障率，搞高了系统可靠性。

- APON：最高速率为622Mbps，二层采用的是ATM封装，目前已弃用。
- **EPON**：可以支持1.25Gbps对称速率，将以太网与PON技术完美结合。
- **GPON**：其技术特色是二层采用ITU-T定义的GFP(通用成帧规程)对Ethernet、TDM、 ATM等多种业务进行封装映射，能提供**1.25Gbps、2.5Gbps** 下行速率和所有标准的上行速率

## 9. 因特网与网络互联技术

### 9.1. IP地址

**网络地址**：主机位全为0的地址。

**广播地址**：主机位全为1的地址。

#### 9.1.1. IP地址表示方法

![](https://lgx_248920070.gitee.io/lgxblog/img/202210132335001.jpg)

IP地址分类：**有分类地址**、 **无分类地址 (CIDR)**

有分类IP地址分为A、B、C、D、E 五大类，根据**网络位**及**主机位**的长度不同来划分。

![](https://lgx_248920070.gitee.io/lgxblog/img/202210132338744.jpg)

其中，A，B，C类地址为单播地址，D类地址为组播地址。

#### 9.1.2. 特殊IP地址

**公有地址**：公有地址（Public address）由Inter NIC（Internet Network Information Center）因特网信息中心负责，这些IP地址分配给注册并向Inter NIC提出申请的组织机构。通过它直接访问因特网。

**私有地址**：属于非注册地址，专门为组织机构内部使用。

| 类别 | IP地址范围                  | 网络号                | 网络数    |
| ---- | --------------------------- | --------------------- | --------- |
| A    | 10.0.0.0~10.255.255.255     | 10                    | $2^0=1$   |
| B    | 172.16.0.0~172.31.255.255   | 172.16~172.31         | $2^4=16$  |
| C    | 192.168.0.0~192.168.255.255 | 192.168.0~192.168.255 | $2^8=256$ |

**单播地址**：1v1	**组播地址**：1v一组	**广播地址**：1v所有

组播地址只能用于目的地址，不能用于源地址。

| 网络号  | 主机号         | 源地址使用 | 目的地址使用 | 代表含义                      |
| ------- | -------------- | ---------- | ------------ | ----------------------------- |
| 0       | 0              | 可以       | 不可以       | 在本网络上的本主机            |
| 全1     | 全1            | 不可以     | 可以         | 在本网络上进行广播            |
| Net-ID  | 全1            | 不可以     | 可以         | 对Net-ID上的所有主机进行广播  |
| 127     | 非全0或全1的数 | 可以       | 可以         | 用作本地软件环回测试使用      |
| 169.254 | 非全0或全1的数 | 可以       | 可以         | Windows主机DHCP服务器故障分配 |

**0.0.0.0**：严格讲这不是—个IP地址， 是在本网络上的本主机。可做源地址。

**255.255.255.255**：限制广播地址。同—广播域的所有主机， 这个地址不被路由转发。可以做目的地。

**127.0.0.1**：本机地址， 用千测试TCP/IP协议能否正常工作。

**169.254.X.X（自动专有地址）**：当DHCP 服务器出现故障或者响应时间太长而超出系统规定时间，Windows 会分配— 个这样的地址。

**224.0.0.0** 是一个组播地址。**224.0.0.1** 指所有主机； **224.0.0.2** 指所有路由器； **224.0.0.5** OSPF路由协议专用。

#### 9.1.3. 子网掩码-子网划分

**子网掩码**：子网掩码与IP地址成对出现， 子网掩码中为1的部分表示网络位，为0的部分表示主机位。**子网掩码网络位为全1**，**主机位为全0**。

**可变长度子网掩码( VLSM )** ： 解决了IP地址空间的利用率很低，两级IP地址不够灵活的问题。

在有类的IP地址的基础上，从它们的**主机号部分借出相应的位数来做网络号**，也就是**增加网络号的位数**用于**子网划分**。

A 类默认子网掩码为：255.0.0.0
B 类默认子网掩码为：255.255.0.0
C 类默认子网掩码为：255.255.255.0

![](https://lgx_248920070.gitee.io/lgxblog/img/202210151652496.jpg)

![](https://lgx_248920070.gitee.io/lgxblog/img/202210151921395.jpg)

#### 9.1.4. 无分类编址CIDR

CIDR是把几个标准网络合并成—个大网络的技术，通过缩短子网掩码长度达到将小网络合并为大的超网。

汇聚思路：将给出的IP地址不相同的位置开始将**十进制数转换为二进制**表示，找相同部分划为网络位，**不同的位划分至主机位**，从而实现将多个网段汇聚成—个新的超网网段。

例： 177.7.97.0/24，177.7.99.0/24，177.7.104.0/24，177.7.112.0/24 汇聚后的地址为？

$97=64+32+1=01100001$

$99=64+32+2+1=01100011$

$104=64+32+8=01101000$

$112=64+32+16=01110000$

共同部分为 $011$ ，所以网络位是$16+3=19$位，主机位是$13$位。

**网络地址**：**主机位全为0**，所以CIDR汇聚后的地址是 177.7.01100000.0/255.255.11100000.0 即 **177.7.96.0/19**

#### 9.1.5. 路由汇聚

**最佳路由匹配原则**：使用路由汇聚时，路由表中的每个项目由“网络前缀”和“下一条地址”组成。查找路由表时不止一个匹配结果。应当从路由匹配结果中**选择最长网络位的路由**，即**子网掩码最长的作为路由**。

### 9.2. IP数据报

![](https://lgx_248920070.gitee.io/lgxblog/img/202210152306154.jpg)

IP 协议有以下特点：

- 不可靠
- 非面向连接
- 当IP包中生存周期（TTL）为0时丢弃数据包

IP 数据报格式：

![](https://lgx_248920070.gitee.io/lgxblog/img/202210161644471.jpg)



**版本**：IP 协议版本。IPV4：0100 IPV6：0110

**首部长度**：占4位，可表示的最大数值为15个单位（一个单位为4字节），因此**首部长度最大值为60字节**。**最小值为20字节**。

**服务类型**： 对IP 数据流业务进行区分，对不同的服务进行服务质量保证。

**总长度**：首部和数据之和的长度。以字节为单位，16bit最大值$2^{16}-1=26635$，所以一个IP数据报最大为**65535**字节。如果**超过**以太网帧结构数据字段**1500字节**时，要进行分片发送。

标识，标志，片位移跟分片相关。

![](https://lgx_248920070.gitee.io/lgxblog/img/202210182257570.jpg)

以太网中MTU=1500，所以3820字节的数据无法一次性发送，需要进行分片。

**标识**：对属于**同—个数据报的各个分片进行标识**。标识相同的分片属于同一个数据报片。

**标志**：最高位保留，中间位DF（Don't Fragment），最后一位MF（More Fragment）。

- **DF=0**：数据报可以进行分片。
- **DF=1**：数据报不可以进行分片。
- **MF=0**：分片是最后一个分片。
- **MF=1**：后面 “还有分片”。

**片偏移**：分片在原分组中的相对位置。其数值等于每个分片第—个数据字节编号/8。

如图所示，第一片数据偏移是来自第一部分的，所以偏移为 $0/8=0$。

第二片数据前是有1480的偏移量，所以偏移为 $1480/8=185$。

第二片数据前是有2960的偏移量，所以偏移为 $2960/8=370$。

**生存周期TTL**：每经过—个路由器TTL值减1，TTL值为0时路由器丢弃数据报。

**协议号**：指出数据报携带的数据使用何种协议。6 表示TCP，17 表示UDP。

**首部校验和**：采用CRC-16循环冗余校验码。

### 9.3.  ARP协议

如果主机A向主机B发送数据，主机A向自己的ARP缓存表中寻找主机B对应的MAC地址，如果有，直接发送；

如果没有，主机A向网络中发送广播，主机B收到广播后，就会将主机A的MAC写入ARP缓存表并以**单播方式**发送ARP应答，（内容包括主机B的IP地址、MAC地址、主机A的IP地址、MAC地址，）主机A收到应答后会更新其ARP缓存表，并发送数据。

ARP分组封装在物理网络的帧中进行传输。

```bash
arp -a # 查看ARP缓存表
arp -d # 清除ARP缓存
arp -s ip-address mac-address # ARP静态绑定
```

静态绑定优先级更高。

### 9.4.  ICMP协议

ICMP(Internet Control Message Protocol) 就是一个“错误侦测与回报机制”，其目的就是让我们能够检测网路的连线状况，也能确保连线的准确性。ICMP 报文控制协议属于**网络层协议**（看起来好像是高层协议，但其实不是。因为**ICMP报文封装在IP数据报**中，作为其中的数据部分）。

ICMP报文分为两种，**ICMP差错报告报文**和**ICMP询问报文**。

**ICMP差错报告报文**：

- 目标不可达（3）：不能把IP数据报送达到目的主机。

- 超时（11）：IP 数据报的生存期已超时（TTL=0）。
- 参数出错（12）：判断出IP数据报头部字段或语义出错。
- 源抑制（4）：网络出现拥塞，发送该报文。
- 重定向（5）：告诉主机—个更短的路由路径。

**ICMP询问报文**：

- 回送请求和回答报文：使用 ping。
- 时间戳请求和回答报文：使用 tracert/traceroute。

**不再发送差错报告报文的情况**：

- 对ICMP差错报告报文不在发送差错报告报文。
- 对第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报告报文。
- 对具有多播地址的数据报不发送ICMP差错报告报文。
- 对特殊地址（127.0.0.0，0.0.0.0）的数据报不发送ICMP差错报告报文。

常用命令为：ping，tracert，traceroute。

**tracert/traceroute**：实际上利用了IP数据报中的TTL字段和ICMP时间超过差错报告报文来实现源点到终点的路径追踪。（发送一连串TTL值不一样的数据报进行追踪。TTL=1，TTL=2 ......）

### 9.5.  IPv6协议

IPv6优点：

- **更快的传输速度**：更大的地址空间；扩展地址层次结构；灵活的首部格式。
- **更安全的传输方式**：改进的选项；允许协议继续扩充。
- **支持即插即用（自动配置）**： 支持资源预分配；对移动端更加友好。

IPv6报文格式：

![](https://lgx_248920070.gitee.io/lgxblog/img/202210182356292.jpg)

IPv6数据报有一个40字节的基本首部，其后允许**有0个或多个扩展首部**，然后是数据部分，**扩展首部**和**数据部分**统称为**有效载荷**。

![](https://lgx_248920070.gitee.io/lgxblog/img/202210190014606.png)

#### 9.5.1. IPv6地址表示

- IPv6地址采用128位地址长度，采用**冒号间隔十六进制**表示。
- 某些 IPV6 地址中有—长串 0，此时**可将连续的 0 压缩为一个 0**。也可以将连续多个 0000 用**双冒号（::）替换**。（**0压缩只能使用一次**，使用多次使地址不确定）。
- 可以在任何十六进制数字组中**删除一个或多个前导零**；通常对全部或全部前导零进行操作。如：**0042缩写为42。**

#### 9.5.2. IPv6地址分级概念（单播）

IPv6扩展了地址分级概念，使用以下三个等级：

- 全球路由选择前缀，48位。前三位固定为001。
- 子网标识符，16位。
- 接口标识符，64位。按MAC地址生成64位。

![](https://lgx_248920070.gitee.io/lgxblog/img/202210190033451.jpg)

#### 9.5.3. IPv6地址类型

- **单播地址（Unicast）**：点对点通信。又分为：**可聚合全球单播地址**、 **链路本地单播地址**和**站点本地单播地址**。
  - **可聚合全球单播地址**：相当于IPv4的公网地址，这类地址由供应商提供，地址的前3 位格式固定为 001，用于区分其他地址类型。
  - **链路本地单播地址**：是单网络链路上给的主机编号，作用是进行链路上主机的通信。 当你配置一个单播IPv6地址的时候，接口上会自动配置一个链路本地单播地址。**通常为FE80开头**，（前10位为1111111010）。网络中**路由器对具有链路本地单播地址的包是不进行处理**的。IPv6的 **“邻居发现” 机制会用到链路本地单播地址**（“邻居发现” 是IPv6中和IPv4中ARP对应的寻址机制）
  - **站点本地单播地址**：类似于IPv4中的私有地址，不能与站点外地址通信，也不能直接连接到全球Internet。

- **组播地址（Multicast）**：一点对多点通信。

- **任播地址（Anycast）**：这是IPv6增加的一种类型，任播的目的站是一组计算机，但是数据报交付时只交付其中一个，通常是**距离最近的一个**。

<table>
    <tr>
        <td colspan="2" style=font-weight:bold>地址类型</td>
        <td  style=font-weight:bold>地址前缀</td>
        <td  style=font-weight:bold>IPv6前缀标识</td>
    </tr>
    <tr>
        <td rowspan="5">单播地址</td>
        <td>未指定地址</td>
        <td>000......0（128bit）</td>
        <td>::/128</td>
    </tr>
    <tr>
        <td>环回地址</td>
        <td>000......1（128bit）</td>
        <td>::1/128</td>
    </tr>
    <tr>
        <td>链路本地单播地址</td>
        <td>1111111010</td>
        <td>FE80::/10</td>
    </tr>
    <tr>
        <td>站点本地单播地址</td>
        <td>1111111011</td>
        <td>FEC0::/10</td>
    </tr>
    <tr>
        <td>可聚合全球单播地址</td>
        <td colspan="2">全球路由选择前缀（48bit），前三位固定为001</td>
    </tr>
    <tr>
        <td>组播地址</td>
        <td></td>
        <td>11111111</td>
        <td>FF00::/8</td>
    </tr>
    <tr>
        <td>任播地址</td>
        <td></td>
        <td colspan="2">从单播地址空间中进行分配，使用单播地址的格式</td>
    </tr>
</table>


#### 9.5.4. IPv6特殊地址

**w.x.y.z** 为IPv4地址的十六进制表示方法。

1. **与IPv4兼容的地址**：0:0:0:0:0:0:w.x.y.z 或 ::w.x.y.z
2. **IPv4映射地址**：0:0:0:0:0:FFFF:w.x.y.z 或 ::FFFF:w.x.y.z
3. **6 to 4 地址**：用于IPv4的网络上传输IPv6的包。完整的 6 to 4主机地址由 6 to 4地址的48位格式前缀（2002:w.x.y.z::/48）和其后面的子网标识符ID以及64位接口ID组成。
4. **ISATAP地址**：ISATAP地址的接口ID必须如下：0000:5EFE:w.x.y.z

#### 9.5.5. IPv4与IPv6协议过度

- **双协议栈**：**同—个主机同时运行IPv4和IPv6两套协议栈**，具有IPv4/IPv6双协议栈的结点称为双栈节点，这些结点既可以收发IPv4报文也可以收发IPv6报文。双栈节点同时包含IPv4和IPv6的网络层，但传输层协议（如 TCP 和 UDP）的使用仍然是单一的。
- **隧道技术**：隧道技术指将另外一个协议数据包的报头直接封装在原数据包报头前，从而可以实现在不同协议的网络上直接进行传输，这种机制用来在IPv4网络之上连接IPv6的站点，站点可以是—台主机，也可以是多个主机。 隧道技术将IPv6的分组封装到IPv4的分组中 ，或者把IPv4的分组封装到IPv6的分组中，封装后的IPv4分组将通过IPv4的路由体系传输或者IPv6的分组进行传输。
- **网络地址转换技术（NAT-PT ）**： NAT-PT 技术附带协议转换器的网络地址转换器。 是—种纯IPv6节点和IPv4节点间的互通方式，所有包括地址、协议在内的转换工作都由网络设备来完成。 NAT-PT包括静态和动态两种 ，两者都提供—对—的IPv6地址和IPv4地址的映射 ，只不过动态 NAT-PT 需要—个IPv4的地址池进行动态的地址转换。

### 9.6.  QOS

**QOS ( Quality of Service，服务质量）**：是用来解决网络延迟和阻塞等问题的一种技术。主要是**区分流量，保证重要流量及时被转发**。

QOS提供以下三种服务模型 ： 

- Best-Effort service （ **尽力而为服务模型** ）
  - 先进先出的转发，通过先进先出队列来实现。
- Integrated service （**综合服务模型** ， 简称 lnt-Serv）
  - 提前申请网络资源，各个节点预留资源。
  - 保证服务：为某一种应用预留资源。
  - 负载控制服务：网络拥塞的条件下，保证应用体验一致。
  - **资源预留协议(RSVP)**：接收方----->发送方，要求中间的设备预留网络资源。
- Differentiated service（**区分服务模型** ，简称 Diff-Serv）
  - **不预留资源**，通过多种方法指定报文的QOS

### 9.7.  传输层概述

**传输层** ( Transport Layer ) 是OSI协议的第四层协议，实现端到端的数据传输。该层是两台计算机经过网络进行数据通信时，第— 个端到端的层次，具有缓冲作用。

当网络层服务质量不能满足要求时，它将服务加以提高，以满足高层的要求； 当网络层服务质量较好时，它只用很少的工作。传输层还可进行复用，即在— 个网络连接上创建多个逻辑连接。

传输层在终端用户之间提供透明的数据传输，向上层提供可靠的数据传输服务。传输层在给定的链路上通过流量控制、分段/重组和差错控制。一些协议是面向链接的。这就意味着传输层能保持对分段的跟踪，并且重传那些失败的分段。

### 9.8.  UDP协议

UDP协议特点：

- 无连接
- 尽最大努力交付’
- 面向报文
- 支持一对一，一对多，多对一和多对多
- 首部开销小

UDP协议报文格式：

![](https://lgx_248920070.gitee.io/lgxblog/img/202210191502911.jpg)
(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{432:function(a,s,t){"use strict";t.r(s);var e=t(1),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"elasticdump使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticdump使用"}},[a._v("#")]),a._v(" elasticdump使用")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/elasticsearch-dump/elasticsearch-dump",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方github地址"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"npm安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#npm安装"}},[a._v("#")]),a._v(" npm安装")]),a._v(" "),s("p",[a._v("安装包下载："),s("a",{attrs:{href:"http://nodejs.cn/download/",target:"_blank",rel:"noopener noreferrer"}},[a._v("nodejs 中文网"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"非root用户安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#非root用户安装"}},[a._v("#")]),a._v(" 非root用户安装")]),a._v(" "),s("p",[a._v("下载 nodejs，解压，并删除压缩包：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://npmmirror.com/mirrors/node/v16.17.0/node-v16.17.0-linux-x64.tar.xz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" xvf node-v16.17.0-linux-x64.tar.xz "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rf")]),a._v(" node-v16.17.0-linux-x64.tar.xz\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("创建新文件夹，用来存放nodejs：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" ~/tools\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("把刚才解压出来的文件夹，移动到tools文件夹下并重命名为nodejs：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" node-v16.17.0-linux-x64 tools/nodejs\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("配置环境变量：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'EOF'"),s("span",{pre:!0,attrs:{class:"token bash punctuation"}},[a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" ~/.bashrc")]),a._v('\nexport PATH="${PATH}:${HOME}/tools/nodejs/bin" \nEOF')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("使修改立即生效：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ~/.bashrc\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("验证版本：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("node")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-V")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"root用户安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#root用户安装"}},[a._v("#")]),a._v(" root用户安装")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"elasticdump安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticdump安装"}},[a._v("#")]),a._v(" elasticdump安装")]),a._v(" "),s("h3",{attrs:{id:"在线安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在线安装"}},[a._v("#")]),a._v(" 在线安装")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" elasticdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-g")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"离线安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#离线安装"}},[a._v("#")]),a._v(" 离线安装")]),a._v(" "),s("p",[a._v("有时候线上环境主机无法访问互联网，这个时候就需要离线安装。")]),a._v(" "),s("p",[a._v("在可联网机器上下载 "),s("code",[a._v("npm-pack-all")]),a._v(" ：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" npm-pack-all "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-g")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("在可联网机器上打包离线安装包，查看 npm 本地目录位置在哪：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" config "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" prefix\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("code",[a._v("; npm local prefix = /home/test/tools")]),a._v("\n进入 "),s("code",[a._v("elasticdump")]),a._v("  本地目录下的 "),s("code",[a._v("lib/node_modules/elasticdump/")]),a._v(" 目录下，执行 "),s("code",[a._v("npm-pack-all")]),a._v(" ，会生成 "),s("code",[a._v(".tgz")]),a._v(" 文件：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /home/test/tools/lib/node_modules/elasticdump/\nnpm-pack-all\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("把  "),s("code",[a._v(".tgz")]),a._v(" 拷贝到离线安装的机器，执行：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" elasticdump-xxx.tgz "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-g")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"elasticdump使用-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticdump使用-2"}},[a._v("#")]),a._v(" elasticdump使用")]),a._v(" "),s("p",[a._v("注：普通的导入导出是100条数据一次，如果是大批量数据的话就很耗时间。"),s("code",[a._v("--limit")]),a._v(" 是一个限制大小的参数，可以根据需求来进行调整其大小。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--limit")]),a._v("\n                    How many objects to move "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" batch per operation\n                    limit is approximate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" streams\n                    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("default: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"拷贝分词-映射-数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#拷贝分词-映射-数据"}},[a._v("#")]),a._v(" 拷贝分词，映射，数据")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#拷贝analyzer分词")]),a._v("\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://staging.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("analyzer\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#拷贝mapping映射")]),a._v("\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://staging.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mapping\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#拷贝data数据")]),a._v("\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://staging.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("data\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br")])]),s("h3",{attrs:{id:"elasticsearch-用户名密码认证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-用户名密码认证"}},[a._v("#")]),a._v(" elasticsearch 用户名密码认证")]),a._v(" "),s("blockquote",[s("p",[a._v("有些符号在URL中是不能直接传递的，如果要在URL中传递这些"),s("a",{attrs:{href:"https://so.csdn.net/so/search?q=%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"}},[a._v("特殊符号"),s("OutboundLink")],1),a._v('，那么就要使用他们的编码了。编码的格式为：%加字符的ASCII码，即一个百分号%，后面跟对应字符的ASCII（16进制）码值。例如 空格的编码值是"%20"。')])]),a._v(" "),s("p",[s("code",[a._v("elasticsearch")]),a._v(" 配置用户名密码时，如果密码有"),s("strong",[a._v("特殊字符")]),a._v("，需要针对进行编码，"),s("a",{attrs:{href:"http://www.jsons.cn/urlencode",target:"_blank",rel:"noopener noreferrer"}},[a._v("URL在线编码解码"),s("OutboundLink")],1),a._v("，也可以采取 "),s("code",[a._v("--httpAuthFile=xxx")]),a._v(" 的格式进行加载用户名密码：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--httpAuthFile")]),a._v("\n                    When using http auth provide credentials "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" ini "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" form\n                    "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("user")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("username"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("password"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("另外一种方式是 "),s("code",[a._v("--input")]),a._v(" 参数和 "),s("code",[a._v("--output")]),a._v(" 参数的的 "),s("code",[a._v("url")]),a._v(" 中添加账号密码，如果密码有"),s("strong",[a._v("特殊字符")]),a._v("，同样需要针对密码进行编码：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("elasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://prod-username:prod-passowrd@production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://stage-username:stage-password@staging.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("data\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"备份到文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#备份到文件"}},[a._v("#")]),a._v(" 备份到文件")]),a._v(" "),s("p",[a._v("针对两个es集群网络不通的情况，可以先备份到文件：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 备份索引数据到文件里:")]),a._v("\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/data/my_index_mapping.json "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mapping\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/data/my_index.json "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("data\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 备份到标准输出，且进行压缩（这里有一个需要注意的地方，我查询索引信息有6.4G，用下面的方式备份后得到一个789M的压缩文件，这个压缩文件解压后有19G）:")]),a._v("\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("$ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("gzip")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" my_index.json.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 把一个查询结果备份到文件中")]),a._v("\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://production.es.com:9200/my_index "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("query.json "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--searchBody")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'{"query":{"term":{"username": "admin"}}}\'')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将备份文件的数据导入ES")]),a._v("\nelasticdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--input")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("./data.json "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://es.com:9200\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);